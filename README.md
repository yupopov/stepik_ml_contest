# Stepik ML contest

Задача с курса [Введение в Data Science и машинное обучение](https://stepik.org/course/4852): для посетителей онлайн-курса «Анализ данных в R» по логам их активности за первые два дня на курсе предсказать, смогут ли они его успешно закончить. Считается, что пользователь прошел курс, если за все время пребывания на нем он смог решить больше 40 задач.

Ответом для каждого пользователя является оценка вероятности успешного завершения им курса, оценка качества осуществляется по метрике ROC-AUC.

Для решения задачи были применены древесные модели (random forest, xgboost), которые показали примерно одинаковое качество (финальный скор = 0.889, входит в 10 лучших результатов), но случайный лес оказался проще в настройке.

## Данные

### Для обучения 
- **/data/events_data_train.zip** — данные о действиях, которые совершают пользователи курса со степами (атомарная единица курса: страница с обучающим видео, задачей, и тому подобное). Содержит следующие колонки:
  - `step_id` — id степа;
  - `timestamp` — время наступления события в формате unix date;
  - `user_id` — анонимизированный id юзера;
  - `action` — действие, возможные значения: 
    - `discovered` — пользователь открыл степ в первый раз;
    - `viewed` — пользователь просмотрел степ;
    - `started_attempt` — начало попытки решить степ с задачей;
    - `passed` — удачное решение практического шага.

- **/data/submissions_data_train.zip** — данные о времени и статусах сабмитов к практическим заданиям. Содержит следующие колонки:
  - `step_id` — id степа;
  - `timestamp` — время отправки решения в формате unix date;
  - `submission_status` — статус решения (`correct` или `wrong`);
  - `user_id` — анонимизированный id юзера.

### Для предсказания
- **/data/events_data_test.zip** — как и *event_data_train.zip*, но содержит данные за первые 2 дня активности каждого пользователя.
- **/data/submissions_data_test.zip** — как и *submissions_data_train.zip*, но содержит данные за первые 2 дня активности каждого пользователя.

## Решение задачи

Содержится в двух Jupyter ноутбуках:
- **main_analysis.ipynb** [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/yupopov/stepik_ml_contest/blob/master/main_analysis.ipynb)
 — основное решение задачи (построение и анализ базового датасета, обучение бейзлайн модели, построение и отбор признаков, настройка гиперпараметров, анализ модели и ее интерпретация). 
- **eda_and_anomalies.ipynb** [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/yupopov/stepik_ml_contest/blob/master/eda_and_anomalies.ipynb) — более подробный первичный анализ базовых данных, сконцентрированный на поиске аномалий в записях действий пользователей, а также исправление неправильных записей (к сожалению, не сильно улучшающее качество решения главной задачи).

## Выводы

Построенную модель (или ее признаковое пространство) можно использовать на других курсах на платформе Stepik для определения пользователей, которые покинут курс, чтобы слать им напоминания, например. В результате анализа первичных данных было выявлено несколько часто встречающихся аномалий логирования, возникающих в определенных местах курса — эту информацию можно использовать для предотвращения ошибок логирования в будущем.
